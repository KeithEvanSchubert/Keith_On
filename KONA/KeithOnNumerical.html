  <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"           "http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><META NAME="GENERATOR" CONTENT="TtH 2.25">                                                                             <title>   {\Huge  Keith On \ldots \\  \huge  Numerical Analysis  \normalsize }</title> <H1 align=center>  <font size="+4"><p>  Keith On ... <br>  <font size="+4"><p>  Numerical Analysis  <font size="+0"></font></font></font><p> </H1><H3 align=center>  K.E. Schubert <br>  Visiting Assistant Professor <br>  Department of Mathematics <br>  University of Redlands </H3><H3 align=center> </H3><p> <H1>Contents </H1><A href="#tth_chAp1">1&nbsp; Preliminaries</A><br><A href="#tth_chAp2">2&nbsp; Zero Finding</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc2.1">2.1&nbsp; Bisection</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc2.2">2.2&nbsp; Newton's Method</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc2.3">2.3&nbsp; Secant</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc2.4">2.4&nbsp; Regula Falsi</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc2.5">2.5&nbsp; Fixed Points</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc2.6">2.6&nbsp; Continuation Methods</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc2.7">2.7&nbsp; Multiple Roots</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc2.8">2.8&nbsp; Sensitivity</A><br><A href="#tth_chAp3">3&nbsp; Interpolation and Approximation</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc3.1">3.1&nbsp; Lagrange Interpolation Basis</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc3.2">3.2&nbsp; Divided Difference</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc3.3">3.3&nbsp; Error</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc3.4">3.4&nbsp; Splines</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc3.5">3.5&nbsp; Least Squares Approximation</A><br><A href="#tth_chAp4">4&nbsp; Integration</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc4.1">4.1&nbsp; Riemann</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc4.2">4.2&nbsp; Trapezoid</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc4.3">4.3&nbsp; Simpson</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc4.4">4.4&nbsp; Richardson</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc4.5">4.5&nbsp; Gaussian Quadrature</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc4.6">4.6&nbsp; Differentiation</A><br><A href="#tth_chAp5">5&nbsp; Differential Equations</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc5.1">5.1&nbsp; General Introduction</A><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc5.1.1">5.1.1&nbsp; Existence</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc5.2">5.2&nbsp; Euler's Method</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc5.3">5.3&nbsp; Runge-Kutta</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc5.4">5.4&nbsp; Fehlberg's Method</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc5.5">5.5&nbsp; Adams-Bashforth</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc5.6">5.6&nbsp; Adams-Moulton</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc5.7">5.7&nbsp; Stability &amp; Stiff Equations</A><br><A href="#tth_chAp6">6&nbsp; Modeling and Simulation</A><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_sEc6.0.1">6.0.1&nbsp; Arms race</A><br> <p><H1>List of Figures </H1>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_fIg3.1">3.1&nbsp;  Gas Thermometer Example</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_fIg3.2">3.2&nbsp;  Least Squares Example</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_fIg5.1">5.1&nbsp;  Existence requirements</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_fIg5.2">5.2&nbsp;  Instability in Euler's Method</A><br>&nbsp;&nbsp;&nbsp;&nbsp;<A href="#tth_fIg5.3">5.3&nbsp;  Stiff Equation</A><br><H1>List of Tables </H1>      <H1><A NAME="tth_chAp1">Chapter 1     </A><br>Preliminaries</H1><A NAME="c-Prelim"></A>      <H1><A NAME="tth_chAp2">Chapter 2     </A><br>Zero Finding</H1><A NAME="c-zero"></A>Almost every interesting problem in mathematics can be reduced to trying to find the zeros of a function.  The next several classes will be spent examining how we find zeros.  In general, you cannot explicitly solve for the zeros so you need to make iterative procedures to find them.  Today we will look at two methods: bisection and Newton's method.        <H2><A NAME="tth_sEc2.1">2.1</A>&nbsp;&nbsp;Bisection</H2>Bisection is a nice method in that it is guaranteed to converge and you can state exactly how many iterations it will take.<p>        <H2><A NAME="tth_sEc2.2">2.2</A>&nbsp;&nbsp;Newton's Method</H2>Newton's Method essentially is an algebraic re-writing of the tangent line of a function at a point.<p>We can then use Taylor's formula to obtain an error bound.        <H2><A NAME="tth_sEc2.3">2.3</A>&nbsp;&nbsp;Secant</H2>Newton's Method requires the knowledge of the first derivative of the function.  Often the derivative is very complicated to evaluate and will take a long (relatively anyway) time to do so.  In many cases the first derivative may not be available.  In some cases it might not even exist at all points in the interval of interest.  Even when it is available it could be near zero which would cause numerical problems in evaluating it, even if it is in the region of convergence.  For all of these regions a new method was devised, which drew on the material leading up to calculus.  <p>Recall that the tangent line was found as the limit of a series of secant lines.  We can say that the derivative can thus be approximated by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>f(x) <font face=symbol>»</font> </td><td nowrap align=center>f(x<sub>1</sub>)-f(x<sub>2</sub>)<hr NOSHADE> x<sub>1</sub>-x<sub>2</sub><Br></td><td nowrap align=center>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Thus if we know two points, we can approximate the funciton by a straight line between them and use the x-intercept as the next point to evaluate.  We now need two points instead of one and a derivative.  We refer to this as a two-point method because of the need of multiple points.  We will need two estimates to begin our evaluation.  Given two initial gueses, x<sub>0</sub> and x<sub>1</sub>, the slope, m, is given by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>m = </td><td nowrap align=center>f(x<sub>1</sub>)-f(x<sub>0</sub>)<hr NOSHADE> x<sub>1</sub>-x<sub>0</sub><Br></td><td nowrap align=center>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Using this we find the next point, x<sub>2</sub> by using the point-slope form of a line<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f(x<sub>2</sub>)-f(x<sub>1</sub>) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>f(x<sub>1</sub>)-f(x<sub>0</sub>)<hr NOSHADE> x<sub>1</sub>-x<sub>0</sub><Br></td><td nowrap align=center>(x<sub>2</sub>- x<sub>1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>x<sub>2</sub>- x<sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>x<sub>1</sub>-x<sub>0</sub><hr NOSHADE> f(x<sub>1</sub>)-f(x<sub>0</sub>)<Br></td><td nowrap align=center>(f(x<sub>2</sub>)-f(x<sub>1</sub>)) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>x<sub>2</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>x<sub>1</sub>-f(x<sub>1</sub>)</td><td nowrap align=center>x<sub>1</sub>-x<sub>0</sub><hr NOSHADE> f(x<sub>1</sub>)-f(x<sub>0</sub>)<Br></td><td nowrap align=center>. </td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We thus have the equation for the next estimate:<A NAME="eq-sec1"></A><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>x<sub>n+1</sub> = x<sub>n</sub>-f(x<sub>n</sub>)</td><td nowrap align=center>x<sub>n</sub>-x<sub>n-1</sub><hr NOSHADE> f(x<sub>n</sub>)-f(x<sub>n-1</sub>)<Br></td><td nowrap align=center>. </td></tabLe></TD><Td width=100 align=right>(2.1)</TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Note that you can store the previous function evaluation and then you will not need to do two function evaluations per iteration.<p>Now we want to calculate the error.  To do this we will subtract eq&nbsp;<A href="#eq-sec1">2.1</A> from <font face=symbol>a</font> = <font face=symbol>a</font>.                            <centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>e<sub>n+1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left><font face=symbol>a</font>- x<sub>n+1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left><font face=symbol>a</font>- </td><td align=left class="cl"><font face=symbol>æ<br>ç<br>è</font></td><td nowrap align=center>x<sub>n</sub>-f(x<sub>n</sub>)</td><td nowrap align=center>x<sub>n</sub>-x<sub>n-1</sub><hr NOSHADE> f(x<sub>n</sub>)-f(x<sub>n-1</sub>)<Br></td><td align=left class="cl"><font face=symbol>ö<br>÷<br>ø</font></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left><font face=symbol>a</font>-</td><td nowrap align=center>f(x<sub>n</sub>)x<sub>n-1</sub>-f(x<sub>n-1</sub>)x<sub>n</sub><hr NOSHADE> f(x<sub>n</sub>)-f(x<sub>n-1</sub>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>f(x<sub>n</sub>)(<font face=symbol>a</font>-x<sub>n-1</sub>)-f(x<sub>n-1</sub>)(<font face=symbol>a</font>-x<sub>n</sub>)<hr NOSHADE> f(x<sub>n</sub>)-f(x<sub>n-1</sub>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>f(x<sub>n</sub>)e<sub>n-1</sub>-f(x<sub>n-1</sub>)e<sub>n</sub><hr NOSHADE> f(x<sub>n</sub>)-f(x<sub>n-1</sub>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>e<sub>n</sub> e<sub>n-1</sub></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>f(x<sub>n</sub>)<hr NOSHADE> e<sub>n</sub><Br></td><td nowrap align=center>-</td><td nowrap align=center>f(x<sub>n-1</sub>)<hr NOSHADE> e<sub>n-1</sub><Br></td><td nowrap align=center></td></tabLe><hr NOSHADE> f(x<sub>n</sub>)-f(x<sub>n-1</sub>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>e<sub>n</sub> e<sub>n-1</sub></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>f(x<sub>n</sub>)<hr NOSHADE> e<sub>n</sub><Br></td><td nowrap align=center>-</td><td nowrap align=center>f(x<sub>n-1</sub>)<hr NOSHADE> e<sub>n-1</sub><Br></td><td nowrap align=center></td></tabLe><hr NOSHADE> x<sub>n</sub>-x<sub>n-1</sub><Br></td><td nowrap align=center></td><td nowrap align=center>x<sub>n</sub>-x<sub>n-1</sub><hr NOSHADE> f(x<sub>n</sub>)-f(x<sub>n-1</sub>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>e<sub>n</sub> e<sub>n-1</sub></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>f(x<sub>n</sub>)<hr NOSHADE> e<sub>n</sub><Br></td><td nowrap align=center>-</td><td nowrap align=center>f(x<sub>n-1</sub>)<hr NOSHADE> e<sub>n-1</sub><Br></td><td nowrap align=center></td></tabLe><hr NOSHADE> x<sub>n</sub>-x<sub>n-1</sub><Br></td><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> f<font face=symbol>¢</font>(<font face=symbol>a</font>)<Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We need to evaluate [(f(x<sub>n</sub>))/( e<sub>n</sub>)], so we will use Taylor's Theorem for f(x) evaluated at <font face=symbol>a</font>.  We find that<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>f(x<sub>n</sub>)<hr NOSHADE> e<sub>n</sub><Br></td><td nowrap align=center></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>f(<font face=symbol>a</font>)+(<font face=symbol>a</font>-x<sub>n</sub>)f<font face=symbol>¢</font>(<font face=symbol>a</font>)+</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>(<font face=symbol>a</font>-x<sub>n</sub>)<sup>2</sup>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>)+<font face="helvetica"><i>O</i></font>((<font face=symbol>a</font>-x<sub>n</sub>)<sup>3</sup>)</td></tabLe><hr NOSHADE> e<sub>n</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>e<sub>n</sub>f<font face=symbol>¢</font>(<font face=symbol>a</font>)+</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>e<sub>n</sub><sup>2</sup>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>) +<font face="helvetica"><i>O</i></font>(e<sub>n</sub><sup>3</sup>)</td></tabLe><hr NOSHADE> e<sub>n</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>f<font face=symbol>¢</font>(<font face=symbol>a</font>)+</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>e<sub>n</sub>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>)+<font face="helvetica"><i>O</i></font>(e<sub>n</sub><sup>2</sup>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Resuming our evaluation of e<sub>n+1</sub> we find                <centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>e<sub>n+1</sub>  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>e<sub>n</sub> e<sub>n-1</sub></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>f<font face=symbol>¢</font>(<font face=symbol>a</font>)+</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>e<sub>n</sub>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>)+<font face="helvetica"><i>O</i></font>(e<sub>n</sub><sup>2</sup>) -f<font face=symbol>¢</font>(<font face=symbol>a</font>)-</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>e<sub>n-1</sub>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>)+<font face="helvetica"><i>O</i></font>(e<sub>n-1</sub><sup>2</sup>)</td></tabLe><hr NOSHADE> x<sub>n</sub>-x<sub>n-1</sub><Br></td><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> f<font face=symbol>¢</font>(<font face=symbol>a</font>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>e<sub>n</sub> e<sub>n-1</sub></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>e<sub>n</sub>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>) -</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>e<sub>n-1</sub>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>)+<font face="helvetica"><i>O</i></font>(e<sub>n-1</sub><sup>2</sup>)</td></tabLe><hr NOSHADE> x<sub>n</sub>-x<sub>n-1</sub><Br></td><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> f<font face=symbol>¢</font>(<font face=symbol>a</font>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>e<sub>n</sub> e<sub>n-1</sub></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>(e<sub>n</sub>-e<sub>n-1</sub>)f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>) +<font face="helvetica"><i>O</i></font>(e<sub>n-1</sub><sup>2</sup>)</td></tabLe><hr NOSHADE> x<sub>n</sub>-x<sub>n-1</sub><Br></td><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> f<font face=symbol>¢</font>(<font face=symbol>a</font>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>e<sub>n</sub> e<sub>n-1</sub></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>(x<sub>n</sub>-x<sub>n-1</sub>)f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>) +<font face="helvetica"><i>O</i></font>(e<sub>n-1</sub><sup>2</sup>)</td></tabLe><hr NOSHADE> x<sub>n</sub>-x<sub>n-1</sub><Br></td><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> f<font face=symbol>¢</font>(<font face=symbol>a</font>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>e<sub>n</sub> e<sub>n-1</sub>(</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>) +<font face="helvetica"><i>O</i></font>(e<sub>n-1</sub><sup>2</sup>))</td><td nowrap align=center>1<hr NOSHADE> f<font face=symbol>¢</font>(<font face=symbol>a</font>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>e<sub>n</sub>e<sub>n-1</sub></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(<font face=symbol>a</font>)<hr NOSHADE> 2f<font face=symbol>¢</font>(<font face=symbol>a</font>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>e<sub>n</sub>e<sub>n-1</sub>M.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This is similar to Newton's method which suggests that<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0> e<sub>n+1</sub> = Ae<sub>n</sub><sup>c</sup>,</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>which implies<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0> e<sub>n</sub> = A<sup>-1</sup>e<sub>n-1</sub><sup>c<sup>-1</sup></sup>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Substituting and collecting terms we find<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>B = e<sub>n</sub><sup>1-c+c<sup>-1</sup></sup>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Since the left hand side is a constant the exponent must be zero, or c must be the golden ratio.This implies that the secant method converges superlinearly.        <H2><A NAME="tth_sEc2.4">2.4</A>&nbsp;&nbsp;Regula Falsi</H2><p>        <H2><A NAME="tth_sEc2.5">2.5</A>&nbsp;&nbsp;Fixed Points</H2>A fixed point is a point in the domain of a function, which maps its domain back into its domain, that satisfies <font face=symbol>a</font> = C(<font face=symbol>a</font>).  Since <font face=symbol>a</font> does not change when it is mapped by the function it is fixed, hence the name.  We need to look at what the idea that underlies fixed points: contractions.  A contraction y = C(x), is a mapping from a closed interval in X into another closed interval in Y with the property that for some b = C(a) (usually a and b are both the origin but it is not required), <font face=symbol>||</font>&#183;<font face=symbol>||</font><sub>x</sub> a norm on X, and <font face=symbol>||</font>&#183;<font face=symbol>||</font><sub>y</sub> a norm on Y we have:<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0><font face=symbol>||</font> x-a<font face=symbol>||</font><sub>x</sub>  &gt;  <font face=symbol>||</font> y-b<font face=symbol>||</font><sub>y</sub> = <font face=symbol>||</font> C(x)-C(a)<font face=symbol>||</font><sub>y</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>for all x <font face=symbol>Î</font> X and y <font face=symbol>Î</font> Y.  Usually we have X and Y are <font face=symbol>Â</font> and a = b, which gives us that <font face=symbol>|</font>x-a<font face=symbol>|</font> &gt; <font face=symbol>|</font>C(x)-a<font face=symbol>|</font>.  Take the derivative of both sides and we see <centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>1 &gt; <font face=symbol>|</font>C<font face=symbol>¢</font>(x)<font face=symbol>|</font>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This brings up a key point, we must have that the magnitude of the function's slope is less than 1.  If you think about this it makes sense, as for slope magnitudes greater than one there will be growth and we are looking a funcions which shrink things.  While this is a simple idea, it has many profound implications.  The book proves nicely how the uniqueness of solution, convergence, etc..  One thing that should be highlated has to do with rate of convergence.  Given a contraction defined on an interval [a,b] with some point, <font face=symbol>a</font> =  C(<font face=symbol>a</font>) <font face=symbol>Î</font> [a,b] called a fixed point, we can define the iteration x<sub>n+1</sub> = C(x<sub>n</sub>).  We then have (using the mean value theorem)<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left><font face=symbol>a</font>-x<sub>n+1</sub>  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>C(<font face=symbol>a</font>)-C(x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>C<font face=symbol>¢</font>(d)(<font face=symbol>a</font>-x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>|</font><font face=symbol>a</font>-x<sub>n+1</sub><font face=symbol>|</font>  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> &lt;  </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0><font face=symbol>|</font><font face=symbol>a</font>-x<sub>n</sub><font face=symbol>|</font>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We have linear convergence from this.  Consider the following paradox.<p>Let a function g(x) be defined by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>g(x) = x-</td><td nowrap align=center>f(x)<hr NOSHADE> f<font face=symbol>¢</font>(x)<Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>and let f(x) have a single root in some interval [a,b].  From the book we know this must have a fixed point in the interval and the iteration x<sub>n+1</sub> = g(x<sub>n</sub>) will converge to the fixed point.  This method thus has linear convergence from what we have proven above.  This iteration is Newton's Method though, so it has Quadratic convergence.  What gives?  The convergence of a fixed point algorithm is at least linear but it can be better if C<font face=symbol>¢</font>(<font face=symbol>a</font>) = 0.  Notice that the derivative of g(x) is given by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>g<font face=symbol>¢</font>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>1-</td><td nowrap align=center>(f<font face=symbol>¢</font>(x))<sup>2</sup>-f(x)f<font face=symbol>¢</font><font face=symbol>¢</font>(x)<hr NOSHADE> (f<font face=symbol>¢</font>(x))<sup>2</sup><Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>f(x)f<font face=symbol>¢</font><font face=symbol>¢</font>(x)<hr NOSHADE> (f<font face=symbol>¢</font>(x))<sup>2</sup><Br></td><td nowrap align=center>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Note that for x = <font face=symbol>a</font> we trivially have that g<font face=symbol>¢</font>(<font face=symbol>a</font>) = 0, which satisfies our requirement for faster convergence.<p>How can I get a function g(x) that satisfies the requirements?  Many ways exist but consider the following.  For a function f(x) with a zero at x = <font face=symbol>a</font> in an interval [a,b], that has <font face=symbol>b</font> = max<sub>x <font face=symbol>Î</font> [a,b]</sub><font face=symbol>|</font>f<font face=symbol>¢</font>(x)<font face=symbol>|</font>, we define the iteration<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>x<sub>n+1</sub> = x<sub>n</sub>-<font face=symbol>g</font>sign(f<font face=symbol>¢</font>(x<sub>n</sub>))f(x<sub>n</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>with 0 &lt; <font face=symbol>g</font><font face=symbol>b</font> &lt; 2.  We then see that<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>g(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>x-<font face=symbol>g</font>sign(f<font face=symbol>¢</font>(x))f(x) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>g<font face=symbol>¢</font>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>1-<font face=symbol>g</font>sign(f<font face=symbol>¢</font>(x))f<font face=symbol>¢</font>(x) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>1-<font face=symbol>g</font><font face=symbol>|</font>f<font face=symbol>¢</font>(x)<font face=symbol>|</font></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>and thus 1 &gt; g<font face=symbol>¢</font>(x) &gt; -1.  Note that if we choose <font face=symbol>g</font> such that 0 &lt; <font face=symbol>g</font><font face=symbol>b</font> &lt; 1 then 1 &gt; g<font face=symbol>¢</font>(x) &gt; 0 and the sequence {x<sub>i</sub>}<sub>i = 0</sub><sup><font face=symbol>¥</font></sup> converges to <font face=symbol>a</font> from one side (no alternating).  The parameter <font face=symbol>g</font> is refered to as the <b>step size</b>.  As a final note, we can use Aitken's <font face=symbol>D</font><sup>2</sup> method as outlined in the book to refine the estimate x<sub>n</sub>.  Replace <font face=symbol>a</font> with [^x]<sub>n</sub> and you have a refinement and acceleration method that will work on any linearly convergent algorithm.  It can thus be used on general fixed point methods.<p>Homework 4.3: 6, 13        <H2><A NAME="tth_sEc2.6">2.6</A>&nbsp;&nbsp;Continuation Methods</H2>One of the essential problems in root finding is to find a good place to start.  We have spoken about the progressively doubling intervals till we find a sign change.  I mentioned this was not the fastest or best, but would work.  I wanted to give you what I think is one of the best.  It is refered to as a continuation method or sometimes a homotopy.<p>A homotopy, h, is a continuous connection between two functions, f and g, that maps one space, X, to another, Y:<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>h:[0,1]&times;X<font face=symbol>®</font> Y</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>such that h(0,x) = g(x) and h(1,x) = f(x).  Two simple homotopies we will use are listed below.<OL type="1"><p><li><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>h(<font face=symbol>l</font>,x) = <font face=symbol>l</font>f(x)+(1-<font face=symbol>l</font>)g(x)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><li><p><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>h(<font face=symbol>l</font>,x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left><font face=symbol>l</font>f(x)+(1-<font face=symbol>l</font>)(f(x)-f(<font face=symbol>a</font><sub>0</sub>)) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>f(x)-(1-<font face=symbol>l</font>)f(<font face=symbol>a</font><sub>0</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr></OL><p>The first one is the most general.  Assume we want to find the roots of f, but we know the roots of g.  By picking a sequence of <font face=symbol>l</font> values from zero to one, we will slowly make the roots move from the known positions of g to the unknown positions of f.  We usually try to pick g so it has the same number of roots as the function f.<p>The second method is a frequently used one if I don't want to find a function g.  We are in essence biasing the original fucntion so that at <font face=symbol>a</font><sub>0</sub> the homotopy has a root for <font face=symbol>l</font> = 0.  This gives a nice starting point.  The following theorem tells us when this will work.<p>   <b>Theorem 1</b> <em>[Ortega and Rheinboldt]If f:</td><td nowrap align=center>( I\mkern-3.2mu R)<BR></td><td noWrap>\nolimits<sup>n</sup><font face=symbol>®</font></td><td nowrap align=center>( I\mkern-3.2mu R)<BR></td><td noWrap>\nolimits<sup>n</sup> is continuously differentiable and if <font face=symbol>||</font>[f<font face=symbol>¢</font>(x)]<sup>-1</sup><font face=symbol>||</font> <font face=symbol>£</font> M on </td><td nowrap align=center>( I\mkern-3.2mu R)<BR></td><td noWrap>\nolimits<sup>n</sup>, then for any <font face=symbol>a</font><sub>0</sub> <font face=symbol>Î</font> </td><td nowrap align=center>( I\mkern-3.2mu R)<BR></td><td noWrap>\nolimits<sup>n</sup> there is a unique curve {<font face=symbol>a</font>(<font face=symbol>l</font>):0 <font face=symbol>£</font> <font face=symbol>l</font> <font face=symbol>£</font> 1} in </td><td nowrap align=center>( I\mkern-3.2mu R)<BR></td><td noWrap>\nolimits<sup>n</sup> such that f(<font face=symbol>a</font>(<font face=symbol>l</font>))-(1-<font face=symbol>l</font>)f(<font face=symbol>a</font><sub>0</sub>) = 0, with 0 <font face=symbol>£</font> <font face=symbol>l</font> <font face=symbol>£</font> 1.  The function <font face=symbol>l</font><font face=symbol>®</font> <font face=symbol>a</font>(<font face=symbol>l</font>) is a continuously differentiable solution to the initial value problem <font face=symbol>a</font><font face=symbol>¢</font> = -[f<font face=symbol>¢</font>(<font face=symbol>a</font>)]<sup>-1</sup>f(<font face=symbol>a</font><sub>0</sub>), where <font face=symbol>a</font>(0) = <font face=symbol>a</font><sub>0</sub>.</em><p>Essentially this tells us if f is smooth and the first derivative doesn't get too close to zero then you can use this start one of our rootfinding methods, for instance Newton's Method.  Often this method is solved by using a numerical integration technique which we will cover in a few weeks.  For instance if Euler's method is used then it turns out to generate Newton's Method in <font face=symbol>l</font>!<p>        <H2><A NAME="tth_sEc2.7">2.7</A>&nbsp;&nbsp;Multiple Roots</H2>One thing that always caused us problems in all our methods is multiple roots.  I will present a simple technique for handling this case.  Let our function, f, with root of multiplicity, 2, be given by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>f(x) = (x-<font face=symbol>a</font>)<sup>2</sup>f<sub>1</sub>(x),</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>where f<sub>1</sub> has no root at <font face=symbol>a</font>.  Take the derivative of f(x) to obtain<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>(x-<font face=symbol>a</font>)f<sub>1</sub>(x)+(x-<font face=symbol>a</font>)<sup>2</sup>f<font face=symbol>¢</font><sub>1</sub>(x) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>(x-<font face=symbol>a</font>)(f<sub>1</sub>(x)+(x-<font face=symbol>a</font>)f<font face=symbol>¢</font><sub>1</sub>(x)) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>(x-<font face=symbol>a</font>)f<sub>2</sub>(x),</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>where f<sub>2</sub>(x) has no root at <font face=symbol>a</font>.  We now have a funcition with a single root at the same place that the original function had a double root.  This can be done for higher multiplicity roots, and does not require knowing <font face=symbol>a</font> as we are taking the derivative then finding <font face=symbol>a</font> using one of our techniques.<p>        <H2><A NAME="tth_sEc2.8">2.8</A>&nbsp;&nbsp;Sensitivity</H2>This is refered to as stability of the roots in the books, but it is more closely related to the sensitivity of a differential equation to perturbations in its coefficients.  For instance, consider a famous problem due to Wilkinson.<p>   <b>Problem 1</b> <em>[Wilkinson]Find the roots of the polynomial f(x) given by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>(x-1)(x-2)<font face=symbol>¼</font>(x-20) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>x<sup>20</sup>-210x<sup>19</sup>+<font face=symbol>¼</font>+20!</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The roots are clearly one through twenty.  Perturb the coefficient -210 to -210-2<sup>-23</sup>.  The change is in one coefficient only, and that in the 7<sup>th</sup> decimal place.  The roots are now<center>        <TaBle><tr><td>1.000000000 </td><td>6.000006944 </td><td align="center">10.095266145<font face=symbol>±</font>0.643500904j </td><tr><td>2.000000000 </td><td>6.999697234 </td><td align="center">11.793633881<font face=symbol>±</font>1.652329728j </td><tr><td>3.000000000 </td><td>8.007267603 </td><td align="center">13.992358137<font face=symbol>±</font>2.518830070j </td><tr><td>4.000000000 </td><td>8.917250249 </td><td align="center">16.730737466<font face=symbol>±</font>2.812624894j </td><tr><td>4.999999928 </td><td>20.846908101 </td><td align="center">19.502439400<font face=symbol>±</font>1.940330347j </td></TaBle>        </center><p>The problem is not roundoff.  The roots of high-order coefficients can be extremely sensitive to changes in the coefficients.  This is a problem particularly when the coefficients are experimentally determined.</em><p>      <H1><A NAME="tth_chAp3">Chapter 3     </A><br>Interpolation and Approximation</H1><A NAME="c-IntApp"></A>We will now look at the problem of finding a polynomial to fit a set of points.  The points could come from measurements in an experiment, or it could come from a complex function we want to approximate.  In either case we will begin by considering the case where we want our polynomial to be exact at these values.  An obvious question is why the emphasis on polynomials, when so many other functions exist.  Indeed we do see the use of other basis (sin and cos in Fourier for example), but still polynomials hold a special place in many applications.  One major reason is the Theorem of Wiestrass from Real Analysis.  It basically says that polynomials can approximate any function (assuming you use the entire basis).<p>        <H2><A NAME="tth_sEc3.1">3.1</A>&nbsp;&nbsp;Lagrange Interpolation Basis</H2>Probably the nicest way to visualize the interpolation polynomials is to consider the Lagrange interpolation basis functions.  For the set of points, {x<sub>0</sub>, x<sub>1</sub>, <font face=symbol>¼</font>, x<sub>n</sub>} define the following polynomial:<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>L<sub>i</sub>(x) = </td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center><font size="-1"></font> <Br><font face=symbol size="+3">Õ<br></font><font size="-1">j <font face=symbol>¹</font> i</font>&nbsp;<br></td><td nowrap>(x-x<sub>j</sub>)</td></tabLe><hr NOSHADE><tabLe border=0><tr><td nowrap align=center> </td><td nowrap align=center><font size="-1"></font> <Br><font face=symbol size="+3">Õ<br></font><font size="-1">j <font face=symbol>¹</font> i</font>&nbsp;<br></td><td nowrap>(x<sub>i</sub>-x<sub>j</sub>)</td></tabLe></td><td nowrap align=center>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We note in particular that L<sub>i</sub>(x<sub>j</sub>) = <font face=symbol>d</font><sub>i,j</sub>, which allows us to get the interpolation polynomial nicely.  The interpolating polynomial is then given by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>P<sub>n</sub>(x) = </td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 0</font>&nbsp;<br></td><td nowrap>y<sub>i</sub>L<sub>i</sub>(x).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The importance of the Lagrange basis giving us the Kronecker delta function cannot be over-emphasized, as it is the essential idea in getting the solution.<p>Often the points are selected to be evenly spaced due to constraints in the basic system.  While this is not the best for errors, it is often a physical necessity (for example many data samplers are constrained this way).  In this case we can simplify the expression using <centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0><font face=symbol>m</font> = </td><td nowrap align=center>x-x<sub>0</sub><hr NOSHADE> x<sub>1</sub>-x<sub>0</sub><Br></td><td nowrap align=center>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This is covered well in the book.<p>        <H2><A NAME="tth_sEc3.2">3.2</A>&nbsp;&nbsp;Divided Difference</H2>Divided difference is a similar method to Taylor approximation but instead of matching derivatives exactly at a point, it nearly approximates the derivative to exactly match certain points.  The result is the same as Lagrange's formula.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>F[x<sub>0</sub>,x<sub>1</sub>] </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>f(x<sub>1</sub>)-f(x<sub>0</sub>)<hr NOSHADE> x<sub>1</sub>-x<sub>0</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>F[x<sub>0</sub>,x<sub>1</sub>,<font face=symbol>¼</font>,x<sub>n</sub>] </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>F[x<sub>1</sub>,<font face=symbol>¼</font>,x<sub>n</sub>]-F[x<sub>0</sub>,<font face=symbol>¼</font>,x<sub>n-1</sub>]<hr NOSHADE> x<sub>n</sub>-x<sub>0</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>P<sub>1</sub>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f(x<sub>0</sub>)+(x-x<sub>0</sub>)F[x<sub>0</sub>,x<sub>1</sub>] </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>P<sub>k+1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>P<sub>k</sub>+(x-x<sub>0</sub>)(x-x<sub>1</sub>)<font face=symbol>¼</font>(x-x<sub>k</sub>)F[x<sub>0</sub>,x<sub>1</sub>,<font face=symbol>¼</font>,x<sub>k+1</sub>]</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>Homework:<p>Section 5.1: 5, 9, 13<p>Section 5.2: 2, 3, 7<p>        <H2><A NAME="tth_sEc3.3">3.3</A>&nbsp;&nbsp;Error</H2>The key area to note from here is that the error is given by either of the following formulas.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f(x)-P<sub>n</sub>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">Õ<br></font><font size="-1">i = 0</font>&nbsp;<br></td><td nowrap>(x-x<sub>i</sub>)</td><td nowrap align=center>f<sup>(n+1)</sup>(c<sub>x</sub>)<hr NOSHADE> (n+1)!<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">Õ<br></font><font size="-1">i = 0</font>&nbsp;<br></td><td nowrap>(x-x<sub>i</sub>)F[x<sub>0</sub>,x<sub>1</sub>,<font face=symbol>¼</font>,x<sub>n</sub>,x]</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The important part of this is to note that these are themselves polynomials of order n+1.  Consider the plot of a polynomial with equi-spaced roots.  It is trivial to note that the height of the peaks between the roots is bigger towards the outside of the interval.        <H2><A NAME="tth_sEc3.4">3.4</A>&nbsp;&nbsp;Splines</H2>For splines we want to fit a cubic polynomial for each interval so that the first and second derivatives between two sections match on the boundary.  Following the books derivation we get the formula for the polynomial on the interval [x<sub>j-1</sub>,x<sub>j</sub>] to be<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>s(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>a<sub>1</sub>(x<sub>j</sub>-x)<sup>3</sup>+a<sub>0</sub>(x-x<sub>j-1</sub>)<sup>3</sup> +b<sub>1</sub>(x<sub>j</sub>-x)+b<sub>0</sub>(x-x<sub>j-1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>a<sub>i</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>M<sub>j-i</sub><hr NOSHADE> 6(x<sub>j</sub>-x<sub>j-1</sub>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>b<sub>i</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>y<sub>j-i</sub>-</td><td nowrap align=center>1<hr NOSHADE> 6<Br></td><td nowrap align=center>M<sub>j-i</sub>(x<sub>j</sub>-x<sub>j-1</sub>)<sup>2</sup></td></tabLe><hr NOSHADE> (x<sub>j</sub>-x<sub>j-1</sub>)<Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The only thing that we need is to calculate M<sub>i</sub> for the natural cubic spline, which is done by requiring M<sub>1</sub> = M<sub>n</sub> = 0 and solving the following matrix system<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>Ax </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>b </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>A </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>n-2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-2</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-2</sub> </td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0><font face=symbol>a</font><sub>n-1</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>x </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>M<sub>2</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0>M<sub>n-1</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b = </td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>g</font><sub>2</sub>-<font face=symbol>g</font><sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0><font face=symbol>g</font><sub>n-1</sub>-<font face=symbol>g</font><sub>n-2</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>a</font><sub>i</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>x<sub>i+1</sub>-x<sub>i-1</sub><hr NOSHADE> 3<Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>b</font><sub>i</sub> = </td><td nowrap align=center>x<sub>i+1</sub>-x<sub>i</sub><hr NOSHADE> 6<Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>g</font><sub>i</sub> = </td><td nowrap align=center>y<sub>i+1</sub>-y<sub>i</sub><hr NOSHADE> x<sub>i+1</sub>-x<sub>i</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We can also find the M<sub>i</sub> for the not-a-knot cubic spline, which is often preferred by solving a similar system<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>Ax </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>b </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>A </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>y</font><sub>1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>n-2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>n-1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-1</sub> </td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0><font face=symbol>f</font><sub>2</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>x </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>M<sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>M<sub>2</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>M<sub>n-1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0>M<sub>n</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b = </td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>g</font><sub>1</sub>-f<font face=symbol>¢</font>(x<sub>1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>g</font><sub>2</sub>-<font face=symbol>g</font><sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>g</font><sub>n-1</sub>-<font face=symbol>g</font><sub>n-2</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0>f<font face=symbol>¢</font>(x<sub>n</sub>)-<font face=symbol>g</font><sub>n-1</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>a</font><sub>i</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>x<sub>i+1</sub>-x<sub>i-1</sub><hr NOSHADE> 3<Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>b</font><sub>i</sub> = </td><td nowrap align=center>x<sub>i+1</sub>-x<sub>i</sub><hr NOSHADE> 6<Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>g</font><sub>i</sub> = </td><td nowrap align=center>y<sub>i+1</sub>-y<sub>i</sub><hr NOSHADE> x<sub>i+1</sub>-x<sub>i</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>y</font><sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>x<sub>2</sub>-x<sub>1</sub><hr NOSHADE> 3<Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>f</font><sub>2</sub> = </td><td nowrap align=center>x<sub>n</sub>-x<sub>n-1</sub><hr NOSHADE> 3<Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>or (if you don't know the derivative) <centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>Ax </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>b </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>A </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>y</font><sub>1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>y</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>3</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>n-2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>a</font><sub>n-1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>b</font><sub>n-1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>2</sub> </td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0><font face=symbol>f</font><sub>1</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>x </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>M<sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>M<sub>2</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>M<sub>n-1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0>M<sub>n</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b = </td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>y</font><sub>3</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>g</font><sub>2</sub>-<font face=symbol>g</font><sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>g</font><sub>n-1</sub>-<font face=symbol>g</font><sub>n-2</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0><font face=symbol>f</font><sub>3</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>a</font><sub>i</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>x<sub>i+1</sub>-x<sub>i-1</sub><hr NOSHADE> 3<Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>b</font><sub>i</sub> = </td><td nowrap align=center>x<sub>i+1</sub>-x<sub>i</sub><hr NOSHADE> 6<Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>g</font><sub>i</sub> = </td><td nowrap align=center>y<sub>i+1</sub>-y<sub>i</sub><hr NOSHADE> x<sub>i+1</sub>-x<sub>i</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>x</font><sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>x<sub>2</sub>-x<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>x</font><sub>2</sub> = x<sub>2</sub>-z<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>x</font><sub>3</sub> = z<sub>1</sub>-x<sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>y</font><sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font face=symbol>x</font><sub>2</sub><sup>3</sup>-<font face=symbol>x</font><sub>1</sub><sup>2</sup><font face=symbol>x</font><sub>2</sub><hr NOSHADE> 6<font face=symbol>x</font><sub>1</sub><Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>y</font><sub>2</sub> = </td><td nowrap align=center><font face=symbol>x</font><sub>3</sub><sup>3</sup>-<font face=symbol>x</font><sub>1</sub><sup>2</sup><font face=symbol>x</font><sub>3</sub><hr NOSHADE> 6<font face=symbol>x</font><sub>1</sub><Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>y</font><sub>3</sub> = f(z<sub>1</sub>)-</td><td nowrap align=center><font face=symbol>x</font><sub>2</sub>y<sub>1</sub>+<font face=symbol>x</font><sub>3</sub>y<sub>2</sub><hr NOSHADE> <font face=symbol>x</font><sub>1</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>x</font><sub>4</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>x<sub>n</sub>-x<sub>n-1</sub>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>x</font><sub>5</sub> = x<sub>n</sub>-z<sub>2</sub>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>x</font><sub>6</sub> = z<sub>2</sub>-x<sub>n-1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>f</font><sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center><font face=symbol>x</font><sub>5</sub><sup>3</sup>-<font face=symbol>x</font><sub>4</sub><sup>2</sup><font face=symbol>x</font><sub>5</sub><hr NOSHADE> 6<font face=symbol>x</font><sub>4</sub><Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>f</font><sub>2</sub> = </td><td nowrap align=center><font face=symbol>x</font><sub>6</sub><sup>3</sup>-<font face=symbol>x</font><sub>4</sub><sup>2</sup><font face=symbol>x</font><sub>6</sub><hr NOSHADE> 6<font face=symbol>x</font><sub>4</sub><Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font face=symbol>f</font><sub>3</sub> = f(z<sub>2</sub>)-</td><td nowrap align=center><font face=symbol>x</font><sub>5</sub>y<sub>n-1</sub>+<font face=symbol>x</font><sub>6</sub>y<sub>n</sub><hr NOSHADE> <font face=symbol>x</font><sub>4</sub><Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>Note, you can easily enter the matrix A into Matlab by using the command diag.  For instance, if you put the entries of A that are on the main diagonal into the vector A1, the first sub-diagonal into A2, and the first super-diagonal into A3, then in Matlab you enter,<i>A=diag(A1)+diag(A2,-1)+diag(A3,1);</i>.<p>Homework<p>section 5.3: 7section 5.4: 3, 5<p>        <H2><A NAME="tth_sEc3.5">3.5</A>&nbsp;&nbsp;Least Squares Approximation</H2><p>Up till know we have dealt with interpolation, where we want to exactly match a set of points.  In reality, we are often more concerned with having a good overall approximation rather than an exact matching at a few points.  There are a lot of ways to approximate a function.  In general there are two main areas discrete and continuous.  We will cover the discrete case.  The continuous method involves some functional analysis and we do not have the time to cover it well.  If you are interested it can provide a fun project, and I have some good resources you can use.<p>We proceed with the discrete case.  The discrete case involves measuring the function to be approximated at a series of points, and then finding the best coefficients in some sense for some functions of interest.  <p>Some sense?  What do I mean by that?  Well, put simply, there are a variety of different methods of measuring how good an approximation is.  The standard method is the one we will concentrate on, and it is called least squares.  As with many things in Math, least squares owes its basis to Gauss.  The basic idea is to reduce the sum of the squares of the distances from the measurements to the function to be fitted at each of the x values.  The last point is very important because it is the basis of much of the problems in least squares.  In essence the answer you get is dependent on your choice of independent variables.  Below is an excerpt from my dissertation which covers what we are talking about now.  The key idea to get is that there are reasons to look beyond least squares.<p>Consider the problem of calibrating a gas thermometer.  Gas thermometers are based on Charles' law, which states that the volume of a fixed mass of gas at a fixed pressure is proportional to its temperature.  A simple gas thermometer can be made by trapping some gas with a mercury plug in a capillary tube that is open on only one end .  The volume is thus proportional to the height of the plug.  The equation of the thermometer is thus hc<sub>1</sub> = T, where h is the height of the plug, c<sub>1</sub> is the constant we want to know, and T is the absolute temperature.  We place the gas thermometer in a stirred liquid bath with a known thermometer.  We heat the bath and take height and temperature measurements at various times.  The LS solution gives us that [^c]<sub>1</sub> = h<sup><font face="helvetica">f</font></sup>T, but we can see that this minimizes the error in the measured temperature, T, from the predicted temperature, hh<sup><font face="helvetica">f</font></sup>T.  By the same token we could use the relation h = c<sub>2</sub>T, with c<sub>2</sub> = [1/( c<sub>1</sub>)].  The LS solution, [^c]<sub>2</sub> = T<sup><font face="helvetica">f</font></sup>h, thus minimizes the error between the measured height, h, and the predicted height TT<sup><font face="helvetica">f</font></sup>h.  A problem arises in the LS method in that generally [^c]<sub>1</sub> <font face=symbol>¹</font> [1/( [^c]<sub>2</sub>)].  This can be seen easily in Figure&nbsp;<A href="#gastherm">3.1</A>.  The slope of the line designated temperature errors, is [^c]<sub>1</sub>, while the slope of the line designated height errors is [1/( [^c]<sub>2</sub>)].  The line designated theoretical is the ``true'' system from which the estimates were generated.  It is easy to see that the slopes are not the same, and thus [^c]<sub>1</sub> <font face=symbol>¹</font> [1/( [^c]<sub>2</sub>)].  The LS solution does not even perfectly handle the case where the system matrix is ``known'', which gives us cause to be concerned as to how it will perform when there are perturbations to the system matrix.<p><p><A NAME="tth_fIg3.1"></A> <center><a href="gastherm.eps">Figure</a></center> <center>      Figure 3.1: Gas Thermometer Example</center><A NAME="gastherm"></A><p><p>The most well known alternative to least squares is total least squares (TLS).  In TLS we look at the perpendicular distance to the function.  This handles many of the problems of least squares but is more sensitive to errors, as it is ``optimistic'' in how it looks at the problem.  A huge body of literature is dedicated to this problem, and this is the central area of my dissertation.  While some of these other methods are very interesting, we will stick to least squares for the moment, but we will remember that problems can occur and so if we have problems we know there are things we can do.<p>Getting back to business we have a set of m points (x<sub>i</sub>,y<sub>i</sub>) and a group of n functions <font face=symbol>f</font><sub>i</sub>(x) that we want to use to approximate the points with.  We thus have m equations to find n coefficients.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>y<sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>- </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>a<sub>i</sub><font face=symbol>f</font><sub>i</sub>(x<sub>1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>y<sub>2</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>- </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>a<sub>i</sub><font face=symbol>f</font><sub>i</sub>(x<sub>2</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>:</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>y<sub>m</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>- </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>a<sub>i</sub><font face=symbol>f</font><sub>i</sub>(x<sub>m</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We can rewrite these into a matrix formulation, as<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>Y-<font face=symbol>F</font>A </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><table><TR><TD nowrap align="right" colspan=0></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>where <centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>Y </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>y<sub>1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>y<sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0>y<sub>m</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>û</font></td><td nowrap align=center><font size="-1">T</font> <Br><font size="-1"></font>&nbsp;<br></td><td nowrap></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>F</font></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ê<br>ê<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>1</sub>(x<sub>1</sub>) </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>2</sub>(x<sub>1</sub>) </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>n</sub>(x<sub>1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>1</sub>(x<sub>2</sub>) </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>2</sub>(x<sub>2</sub>) </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>n</sub>(x<sub>2</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><sup><big>&#183;</big></sup>&#183;<sub><big>&#183;</big></sub></td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>:</td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>1</sub>(x<sub>m</sub>) </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>f</font><sub>2</sub>(x<sub>m</sub>) </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0><font face=symbol>f</font><sub>n</sub>(x<sub>m</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>ú<br>ú<br>ú<br>û</font></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>A </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td align=left class="cl"><font face=symbol>é<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>a<sub>1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>a<sub>2</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center><font face=symbol>¼</font></td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0>a<sub>m</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>û</font></td><td nowrap align=center><font size="-1">T</font> <Br><font size="-1"></font>&nbsp;<br></td><td nowrap>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>At this point we want to minimize the square error which is what the 2-norm does, so we have min<sub>A</sub><font face=symbol>||</font> Y-<font face=symbol>F</font>A<font face=symbol>||</font><sub>2</sub><sup>2</sup> .  The norm we are minimizing is called the cost function.  The solution is given by A = <font face=symbol>F</font><sup><font face="helvetica">f</font></sup>Y, where <font face=symbol>F</font><sup><font face="helvetica">f</font></sup> is called the pseudo-inverse of <font face=symbol>F</font>.  Prove it?  Sure!  To avoid getting into some deeper areas of linear algebra we will assume that <font face=symbol>F</font> has linearly independent columns.  This is not restrictive, as we usually have a lot of measurements and only a few functions we want to fit to them (m &gt;&gt; n).<p>We recall from calculus that the minimum occurs when the gradient (derivative) is zero. We thus take the gradient of the cost with respect to A and set it equal to zero to obtain <centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>0 </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left><font face=symbol>Ñ</font><sub>A</sub><font face=symbol>||</font> Y-<font face=symbol>F</font>A<font face=symbol>||</font><sub>2</sub><sup>2</sup> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left><font face=symbol>Ñ</font><sub>A</sub>(Y-<font face=symbol>F</font>A)<sup>T</sup>(Y-<font face=symbol>F</font>A) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>-<font face=symbol>F</font><sup>T</sup>(Y-<font face=symbol>F</font>A) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left><font face=symbol>F</font><sup>T</sup><font face=symbol>F</font>A-<font face=symbol>F</font><sup>T</sup>Y </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>F</font><sup>T</sup>Y </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0><font face=symbol>F</font><sup>T</sup><font face=symbol>F</font>A</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The last line is what is referred to as the normal equation(s).  Note that some pluralize it to reflect that the single matrix equation reflects n scalar equations.  I don't care, use what you like.  We note that if <font face=symbol>F</font> has linearly independent columns, then (<font face=symbol>F</font><sup>T</sup><font face=symbol>F</font>)<sup>-1</sup> exists.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left><font face=symbol>F</font><sup>T</sup><font face=symbol>F</font>A </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left><font face=symbol>F</font><sup>T</sup>Y </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>A </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>(<font face=symbol>F</font><sup>T</sup><font face=symbol>F</font>)<sup>-1</sup><font face=symbol>F</font><sup>T</sup>Y </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>A </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0><font face=symbol>F</font><sup><font face="helvetica">f</font></sup>Y</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>You might wonder how the last step works.  Some might just call it a definition but in reality it is because (<font face=symbol>F</font><sup>T</sup><font face=symbol>F</font>)<sup>-1</sup><font face=symbol>F</font><sup>T</sup> satisfies the four conditions of a pseudo inverse (called the Penrose conditions).  <OL type="1"><p><li> <font face=symbol>F</font><font face=symbol>F</font><sup><font face="helvetica">f</font></sup><font face=symbol>F</font> = <font face=symbol>F</font><li> <font face=symbol>F</font><sup><font face="helvetica">f</font></sup><font face=symbol>F</font><font face=symbol>F</font><sup><font face="helvetica">f</font></sup> = <font face=symbol>F</font><sup><font face="helvetica">f</font></sup><li> <font face=symbol>F</font><font face=symbol>F</font><sup><font face="helvetica">f</font></sup> = (<font face=symbol>F</font><font face=symbol>F</font><sup><font face="helvetica">f</font></sup>)<sup>T</sup><li> <font face=symbol>F</font><sup><font face="helvetica">f</font></sup><font face=symbol>F</font> = (<font face=symbol>F</font><sup><font face="helvetica">f</font></sup><font face=symbol>F</font>)<sup>T</sup></OL><p>The properties are simple and easy to check, and yes, you have to check all four.  Many times a candidate matrix fails only one of them.  The first two properties tell us that it correctly maps the range spaces from the fundamental theorem of linear algebra, and the second two tell us the composite maps are symmetric.  The pseudo-inverse always exists and is unique.  Additionally, when the true inverse exists, it is the pseudo-inverse.  These are just a few of the many reasons to love the pseudo-inverse...<p>The result is established.  The nice thing about how we have handled things here is we have not specified what the functions are (they have to be linearly independent but that is no problem) or how many of them we want to fit.  You can now fit any combination of functions you like.<p>As an example let's look at linear least squares for the points (0,1), (1,2), and (2,3).  We need to find the coefficients m, and b for the line.  We construct our matrices<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>Y </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>1 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>2 </td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0>3</td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>û</font></td><td nowrap align=center><font size="-1">T</font> <Br><font size="-1"></font>&nbsp;<br></td><td nowrap></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left><font face=symbol>F</font></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>1 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>1 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>1 </td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center>0 </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>1 </td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0>2 </td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>û</font></td><td nowrap align=center><font size="-1">T</font> <Br><br><font size="-1"></font>&nbsp;<br></td><td nowrap></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>A </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td align=left class="cl"><font face=symbol>é<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>b </td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0>m</td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>û</font></td><td nowrap align=center><font size="-1">T</font> <Br><font size="-1"></font>&nbsp;<br></td><td nowrap>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>As a second example, consider fitting e<sup>ax</sup> to (0,1), (1,.5), and (2,.25).  To separate the coefficient, a, from the variable, x we take the natural log of y<sub>i</sub> = e<sup>ax<sub>i</sub></sup> to obtain ln(y<sub>i</sub>) = ax.  We can proceed as before now.<p>As a third example we will consider the second problem where we have noise (random errors) in the measurements.  These three examples are coded into Matlab by<DL compact><dt><b></b></dt>	<dd><pre>Y=[1;2;3];Ye=log([1;.5;.25]);Yee=log([1;.5;.25]+.3*rand(3,1));X=[0;1;2];One=ones(3,1);Phi=[One,X];A=Phi\Ynorm(Y-Phi*A)Ae=X\YeAee=X\YeeXf=0:.05:2;Yfe=exp(Ae.*Xf);Yfee=exp(Aee.*Xf);p1=[-.1,2.1];p2=[-.1,3.1];q=[0,0];subplot(3,1,1)plot(X,Y,'w*',X,Phi*A,'w-',p1,q,'w-',q,p2,'w-')axis([p1,p2])subplot(3,1,2)plot(X,exp(Ye),'w*',Xf,Yfe,'w-',p1,q,'w-',q,p2,'w-')axis([p1,p2])subplot(3,1,3)plot(X,exp(Yee),'w*',Xf,Yfee,'w-',p1,q,'w-',q,p2,'w-')axis([p1,p2])</pre></DL><p>and we get the output below and in Fig&nbsp;<A href="#llsqex">3.2</A>.<DL compact><dt><b></b></dt>	<dd><pre>A =    1.0000    1.0000ans =    0Ae =   -0.6931Aee =   -0.4650</pre></DL><p><p><A NAME="tth_fIg3.2"></A> <center><a href="LinLeastSq1.eps">Figure</a></center> <center>      Figure 3.2: Least Squares Example</center><A NAME="llsqex"></A><p><p>Homework 8.6: 1,3<p>      <H1><A NAME="tth_chAp4">Chapter 4     </A><br>Integration</H1><A NAME="c-Integ"></A>The fundamental theorem of Calculus tells us that an integral of a function can be expressed in terms of the anti-derivative of the function.  Unfortuneately, not all functions have anti-derivatives that are expressable in known functions.  One of the most famous is the Gaussian probability distribution, which is given by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>e<sup>-([(x-<font face=symbol>m</font>)/( <font face=symbol>s</font>)])<sup>2</sup></sup>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The anti-derivative of this important and frequently occuring function is unknown.  How do we handle it?  That is the subject of this chapter.<p>        <H2><A NAME="tth_sEc4.1">4.1</A>&nbsp;&nbsp;Riemann</H2>We recall from Calculus that the integral is defined as<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">b</font> <Br><br><font size="-1">a</font>&nbsp;<br></td><td nowrap>f(x)dx = </td><td nowrap align=center><font size="-1"></font> <Br>lim<BR><font size="-1">n<font face=symbol>®</font><font face=symbol>¥</font></font>&nbsp;<br></td><td nowrap></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(p<sub>j</sub>)(x<sub>j</sub>-x<sub>j-1</sub>).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Now assume that all n of the x<sub>j</sub> are evenly spaced on [a,b].  We can then write<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>h </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>b-a<hr NOSHADE> n<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>x<sub>j</sub>-x<sub>j-1</sub>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We can use this to get an expression for the Riemann Sum<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">b</font> <Br><br><font size="-1">a</font>&nbsp;<br></td><td nowrap>f(x)dx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1"></font> <Br>lim<BR><font size="-1">n<font face=symbol>®</font><font face=symbol>¥</font></font>&nbsp;<br></td><td nowrap></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(p<sub>j</sub>)(x<sub>j</sub>-x<sub>j-1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1"></font> <Br>lim<BR><font size="-1">n<font face=symbol>®</font><font face=symbol>¥</font></font>&nbsp;<br></td><td nowrap></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(p<sub>j</sub>)h </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center><font size="-1"></font> <Br>lim<BR><font size="-1">n<font face=symbol>®</font><font face=symbol>¥</font></font>&nbsp;<br></td><td nowrap>h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(p<sub>j</sub>).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>To evaluate the integral numerically we are not able to take the limit, so we get<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">b</font> <Br><br><font size="-1">a</font>&nbsp;<br></td><td nowrap>f(x)dx  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(p<sub>j</sub>).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The exact size of n for the approximation to be good is a key aspect of numerical integration.  Note also that I have not specified what p<sub>j</sub> is, as this form allows you to do a left, right, mid-point, maximum, or minimum.  The basic idea here is that we are approximating the function by a constant on the interval.<p><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">b</font> <Br><br><font size="-1">a</font>&nbsp;<br></td><td nowrap>f(x)dx  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(p<sub>j</sub>).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>Now we want to think about the error.  First we want to get an expression for the integral in terms of an exact sum.  To do this we use the fundamental theorem of calculus, add nothing, rearrange, and use the mean value theorem.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">b</font> <Br><br><font size="-1">a</font>&nbsp;<br></td><td nowrap>f(x)dx</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>F(b)-F(a) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>F(x<sub>n</sub>)-F(x<sub>0</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>F(x<sub>n</sub>)+</td><td nowrap align=center><font size="-1">n-1</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>(F(x<sub>i</sub>)-F(x<sub>i</sub>))-F(x<sub>0</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>(F(x<sub>i</sub>)-F(x<sub>i-1</sub>)) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>f(c<sub>i</sub>)(x<sub>i</sub>-x<sub>i-1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>f(c<sub>i</sub>)h </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>f(c<sub>i</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This expression is exact so we can take it and subtract the expression for the midpoint method.  We will assume the function has a derivative and we will note that since we have picked the midpoint that any other point in the interval is within half the width of the interval of the midpoint.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>E</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>f(c<sub>i</sub>) - h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>f(p<sub>i</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>(f(c<sub>i</sub>) - f(p<sub>i</sub>)) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>f<font face=symbol>¢</font>(d<sub>i</sub>)(c<sub>i</sub> - p<sub>i</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>£</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>h</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>f<font face=symbol>¢</font>(d<sub>i</sub>)</td><td nowrap align=center>h<hr NOSHADE> 2<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>f<font face=symbol>¢</font>(d<sub>i</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Recall that h is inversely proportional to n, so we have that the Error is inversely proportional to the square of n.<p>        <H2><A NAME="tth_sEc4.2">4.2</A>&nbsp;&nbsp;Trapezoid</H2><p><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">b</font> <Br><br><font size="-1">a</font>&nbsp;<br></td><td nowrap>f(x)dx  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>h</td><td align=left class="cl"><font face=symbol>æ<br>ç<br>è</font></td><td nowrap align=center>f(x<sub>0</sub>)+f(x<sub>n</sub>)<hr NOSHADE> 2<Br></td><td nowrap align=center>+</td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(x<sub>j</sub>)</td><td align=left class="cl"><font face=symbol>ö<br>÷<br>ø</font></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>        <H2><A NAME="tth_sEc4.3">4.3</A>&nbsp;&nbsp;Simpson</H2><p><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">b</font> <Br><br><font size="-1">a</font>&nbsp;<br></td><td nowrap>f(x)dx  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>h<hr NOSHADE> 3<Br></td><td nowrap align=center></td><td align=left class="cl"><font face=symbol>æ<br>è</font></td><td nowrap align=center>f(x<sub>0</sub>)+f(x<sub>n</sub>)+2</td><td nowrap align=center><font size="-1"><sup>n</sup>/<sub>2</sub>-1</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(x<sub>2j</sub>)+4</td><td nowrap align=center><font size="-1"><sup>n</sup>/<sub>2</sub></font> <Br><font face=symbol size="+3">å<br></font><font size="-1">j = 1</font>&nbsp;<br></td><td nowrap>f(x<sub>2j-1</sub>)</td><td align=left class="cl"><font face=symbol>ö<br>ø</font></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>        <H2><A NAME="tth_sEc4.4">4.4</A>&nbsp;&nbsp;Richardson</H2><p>Define the value of the integral to be I and the numeric approximation by some method at n node points to be I<sub>n</sub>.  We note that the error is of the form<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>E</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>I-I<sub>n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>c<hr NOSHADE> n<sup>p</sup><Br></td><td nowrap align=center>,</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>with c a constant dependent on the function and p a power dependent on the method.  For midpoint and trapezoidal methods p = 2, while for Simpson's method p = 4.  If we double the number of points then the error would be<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>E</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>I-I<sub>2n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>c<hr NOSHADE> 2<sup>p</sup>n<sup>p</sup><Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>(I-I<sub>n</sub>).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Solving for I we find<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>I-I<sub>2n</sub></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>(I-I<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>I-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>I</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>I<sub>2n</sub></td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>I<sub>n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>2<sup>p</sup>-1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>I</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>I<sub>2n</sub>-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>I<sub>n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>I</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>2<sup>p</sup><hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>I<sub>2n</sub>-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>I<sub>n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>I</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>(2<sup>p</sup>I<sub>2n</sub>-I<sub>n</sub>).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This is Richardson's Extrapolation formula, and it will typically give a big improvement to any of the methods.  We can use this extimate of the error to calculate the error<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>E</td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>I-I<sub>2n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>2<sup>p</sup><hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>I<sub>2n</sub>-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>I<sub>n</sub>-I<sub>n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>2<sup>p</sup>-(2<sup>p</sup>-1)<hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>I<sub>2n</sub>-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>I<sub>n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>I<sub>2n</sub>-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>I<sub>n</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup>-1<Br></td><td nowrap align=center>(I<sub>2n</sub>-I<sub>n</sub>).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This is Richardson's error formula.  We note that we can get a convergence rate by doing a little algebra on what we have already found.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>I-I<sub>2n</sub></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>(I-I<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>I-I<sub>n</sub><hr NOSHADE> I-I<sub>2n</sub><Br></td><td nowrap align=center></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>2<sup>p</sup></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This is a nice equation but in general it is not calculable, as we don't know I and might not know p.  We can handle this by considering the quantity<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>I<sub>2n</sub>-I<sub>n</sub><hr NOSHADE> I<sub>4n</sub>-I<sub>2n</sub><Br></td><td nowrap align=center></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>I<sub>2n</sub>-I<sub>n</sub>+I-I<hr NOSHADE> I<sub>4n</sub>-I<sub>2n</sub>+I-I<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>(I-I<sub>n</sub>)-(I-I<sub>2n</sub>)<hr NOSHADE> (I-I<sub>2n</sub>)-(I-I<sub>4n</sub>)<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>(I-I<sub>n</sub>)-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>(I-I<sub>n</sub>)</td></tabLe><hr NOSHADE><tabLe border=0><tr><td nowrap align=center> </td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>(I-I<sub>n</sub>)-</td><td nowrap align=center>1<hr NOSHADE> 4<sup>p</sup><Br></td><td nowrap align=center>(I-I<sub>n</sub>)</td></tabLe></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>1-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center></td></tabLe><hr NOSHADE><tabLe border=0><tr><td nowrap align=center> </td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>(1-</td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center>)</td></tabLe></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>1<hr NOSHADE><tabLe border=0><tr><td nowrap align=center> </td><td nowrap align=center>1<hr NOSHADE> 2<sup>p</sup><Br></td><td nowrap align=center></td></tabLe></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>2<sup>p</sup>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We thus have a simple way of calculating the convergence rate, and thus a way to find p.<p>Homework: 7.1) 2(a), (b), (f) for midpoint, trapezoidal, and simpson.  Compare with the error for trapezoidal (7.32) and Richardson's extrapolation.<p>7.2) 8<p>        <H2><A NAME="tth_sEc4.5">4.5</A>&nbsp;&nbsp;Gaussian Quadrature</H2><p>And now for something completely different...<p>Last time we considered the standard way of thinking about integration, namely summing up a bunch of small areas.  The technique we will discuss today was introduced in 1814 by Gauss, hence the name.We will now consider the integral<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>I(f) = </td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>f(x)dx.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We note that this is a perfectly general statement as we note that if we define t = (2x-a-b)/(b-a) then<p><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">b</font> <Br><br><font size="-1">a</font>&nbsp;<br></td><td nowrap>f(x)dx  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>f</td><td align=left class="cl"><font face=symbol>æ<br>ç<br>è</font></td><td nowrap align=center>(b-a)t+b+a<hr NOSHADE> 2<Br></td><td align=left class="cl"><font face=symbol>ö<br>÷<br>ø</font></td><td nowrap align=center></td><td align=left class="cl"><font face=symbol>æ<br>ç<br>è</font></td><td nowrap align=center>b-a<hr NOSHADE> 2<Br></td><td align=left class="cl"><font face=symbol>ö<br>÷<br>ø</font></td><td nowrap align=center>dt</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>We have that the integral is general, if not all that obvious as to why we chose this in the first place (it will become more apparent in a few moments).  We still need to show how to estimate the integral.The basic idea is to approximate the integral by weighted evaluations of the function at a series of node points.  To get a good estimate we will require that our estimate at n node points will be good for every polynomial up to order 2n-1.  How?  Pick w<sub>i</sub> and x<sub>i</sub> such that<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>I(f) = </td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">å<br></font><font size="-1">i = 1</font>&nbsp;<br></td><td nowrap>w<sub>i</sub>f(x<sub>i</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>holds for all f <font face=symbol>Î</font> {1,x,<font face=symbol>¼</font>,x<sup>2n-1</sup>}.  Let's do some examples.<p>Consider n = 1.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>dx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>f(x<sub>1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>2 </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>xdx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>x<sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>0 </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>2x<sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>0 </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>x<sub>1</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>Also, consider n = 2.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>dx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>f(x<sub>1</sub>)+w<sub>2</sub>f(x<sub>2</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>2 </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>+w<sub>2</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>xdx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>f(x<sub>1</sub>)+w<sub>2</sub>f(x<sub>2</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>0 </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>x<sub>1</sub>+w<sub>2</sub>x<sub>2</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>x<sup>2</sup>dx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>f(x<sub>1</sub>)+w<sub>2</sub>f(x<sub>2</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>2<hr NOSHADE> 3<Br></td><td nowrap align=center></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>x<sub>1</sub><sup>3</sup>+w<sub>2</sub>x<sub>2</sub><sup>3</sup> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>x<sup>3</sup>dx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub>f(x<sub>1</sub>)+w<sub>2</sub>f(x<sub>2</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>0 </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>w<sub>1</sub>x<sub>1</sub><sup>4</sup>+w<sub>2</sub>x<sub>2</sub><sup>4</sup></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Solve these four equations for four unknowns and we find<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>w<sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>1 </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>w<sub>2</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>1 </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>x<sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>-</td><td nowrap align=center>1<hr NOSHADE> <font face=symbol>Ö</font>3<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>x<sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>1<hr NOSHADE> <font face=symbol>Ö</font>3<Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The node points turn out to be the roots of the Legendre polynomials.  The Legendre polynomials are defined on [-1,1] hence our choice for the limits of integration.  You can find the Legendre polynomials by the following properties.<UL><p><li>P<sub>n</sub> is a polynomial of order n.<li><p>They are orthogonal<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>P<sub>i</sub>(x)P<sub>j</sub>(x)dx = 0</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>when i <font face=symbol>¹</font> j.<li><p>The normalization is<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap>P<sub>n</sub>(x)<sup>2</sup>dx = </td><td nowrap align=center>2<hr NOSHADE> 2n+1<Br></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr></UL><p>The first several Legendre polynomials are {1,x,x<sup>2</sup>-<sup>1</sup>/<sub>3</sub>,x<sup>3</sup>-<sup>3</sup>/<sub>5</sub>x,x<sup>4</sup>-<sup>6</sup>/<sub>7</sub>x<sup>2</sup>+[3/ 35]}.<p>The constants can be found by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>w<sub>i</sub> = </td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">1</font> <Br><br><font size="-1">-1</font>&nbsp;<br></td><td nowrap></td><td nowrap align=center><font size="-1">n</font> <Br><font face=symbol size="+3">Õ<br></font><font size="-1">j = 1, j <font face=symbol>¹</font> i</font>&nbsp;<br></td><td nowrap></td><td nowrap align=center>x-x<sub>j</sub><hr NOSHADE> x<sub>i</sub>-x<sub>j</sub><Br></td><td nowrap align=center>dx</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>In general we do not need to use this as the values are well tabulated.<p>Homework Redo 7.1) 2(a), (b), (f) for gaussian quadrature up to n = 8.  How does the convergence compare?<p>        <H2><A NAME="tth_sEc4.6">4.6</A>&nbsp;&nbsp;Differentiation</H2><p>Numerical differentiation seems obvious.  In most introductions to calculus, the deriviative is introduced as the limit of a series of secant lines.  Probably the most basic method of numerically taking the derivative is based off this formula.  It turns out that while it seems obvious, numerical derivatives are more difficult as we will see.<p>Let's start at the basics, the two point method of obtaining the derivative is based off taking the derivative of the two point interpolation polynomial.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>x<sub>1</sub>-x<hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>0</sub>)+</td><td nowrap align=center>(x-x<sub>0</sub><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>-1<hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>0</sub>)+</td><td nowrap align=center>1<hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>f(x+h)-f(x)<hr NOSHADE> h<Br></td><td nowrap align=center>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We can see how the basic errors are dealt with by expanding the Taylor sequence.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>f(x+h) = f(x)+hf<font face=symbol>¢</font>(x)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Using the Taylor series in the formula we obtain that the error in the formula is<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>E </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x)-</td><td nowrap align=center>f(x+h)-f(x)<hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x)-</td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>f(x)+hf<font face=symbol>¢</font>(x)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c)-f(x)</td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x)-</td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>hf<font face=symbol>¢</font>(x)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c)</td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x)-f<font face=symbol>¢</font>(x)+</td><td nowrap align=center>h<hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>h<hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Two other types of error occur.  First, there is subtractive difference errors.  We note that since f(x) <font face=symbol>»</font> f(x+h), when we subtract them we will lose precision.  Second, there is error propagation.  Consider the fact that nothing we do in the real world is ever exact, so we actually measure and calculate a nearby solution:<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>~<br>f<Br>&nbsp;<br></td><td nowrap align=center>(x)+<font face=symbol>e</font><sub>1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>f(x+h) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>~<br>f<Br>&nbsp;<br></td><td nowrap align=center>(x+h)+<font face=symbol>e</font><sub>2</sub>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Substituting this into our formula we find<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>f(x+h)-f(x)<hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>~<br>f<Br>&nbsp;<br></td><td nowrap align=center>(x+h)+<font face=symbol>e</font><sub>2</sub>-</td><td nowrap align=center>~<br>f<Br>&nbsp;<br></td><td nowrap align=center>(x)+<font face=symbol>e</font><sub>1</sub></td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>~<br>f<Br>&nbsp;<br></td><td nowrap align=center>(x+h)-</td><td nowrap align=center>~<br>f<Br>&nbsp;<br></td><td nowrap align=center>(x)</td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>+</td><td nowrap align=center><font face=symbol>e</font><sub>2</sub>-<font face=symbol>e</font><sub>1</sub><hr NOSHADE> h<Br></td><td nowrap align=center>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The resulting error is<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>E </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x)-</td><td nowrap align=center>f(x+h)-<font face=symbol>e</font><sub>2</sub>-f(x)+<font face=symbol>e</font><sub>1</sub><hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x)-</td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>f(x)+hf<font face=symbol>¢</font>(x)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c)-<font face=symbol>e</font><sub>2</sub>-f(x)+<font face=symbol>e</font><sub>1</sub></td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x)-</td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>hf<font face=symbol>¢</font>(x)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c)-<font face=symbol>e</font><sub>2</sub>+<font face=symbol>e</font><sub>1</sub></td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f<font face=symbol>¢</font>(x)-f<font face=symbol>¢</font>(x)+</td><td nowrap align=center>h<hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c)+</td><td nowrap align=center><font face=symbol>e</font><sub>1</sub>-<font face=symbol>e</font><sub>2</sub><hr NOSHADE> h<Br></td><td nowrap align=center></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>h<hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font><font face=symbol>¢</font>(c)+</td><td nowrap align=center><font face=symbol>e</font><hr NOSHADE> h<Br></td><td nowrap align=center>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>As long as the last term is non-zero, which it will be in general, if h gets to small them the propagation errors dominate.  This is the real problem.  We did not have this problem with numerical integration because we were multiplying by h rather than dividing by it.  The problem is more pronounced with higher order derivatives where you will be dividing by powers of h.  This problem motivates the use of integral equations rather than differential ones.  Unfortuneately many integral equations are very ill-conditioned.  Anyway, the key idea is that there is a competition between several error types.<p>three point formula<p>Richardson<p>      <H1><A NAME="tth_chAp5">Chapter 5     </A><br>Differential Equations</H1><A NAME="c-DifEq"></A>Most practical problems will be described by a differential equation.  We will not in general know the form of the solution, but we usually can find how they change with respect to each other.  From this basis we would like to be able to find the actual solution.<p>        <H2><A NAME="tth_sEc5.1">5.1</A>&nbsp;&nbsp;General Introduction</H2><p>Consider the general differential equation<A NAME="DifEq-e1"></A><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>y<font face=symbol>¢</font>(x) = f(x,y(x)). </td></tabLe></TD><Td width=100 align=right>(5.1)</TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Using basic calculus we see that the solution is given by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>y(x) = </td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center>f(x,y(x))dx+c.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Often this is not very useful in solving equations however.  The way to get practical solutions for this problem is covered in differential equations, so I will just mention a few.<p>      <H3><A NAME="tth_sEc5.1.1">5.1.1</A>&nbsp;&nbsp;Existence</H3>The problem&nbsp;<A href="#DifEq-e1">5.1</A> has a solution on an interval x<sub>0</sub> <font face=symbol>£</font> x <font face=symbol>£</font> min(b<sub>x</sub>,c) and y<sub>0</sub> <font face=symbol>£</font> y <font face=symbol>£</font> b<sub>y</sub> if the function f is continuous on the interval for c = [(<font face=symbol>||</font>y-y<sub>0</sub><font face=symbol>||</font>)/( max<sub>x,y</sub>([(<font face=symbol>¶</font>f(x,y))/( <font face=symbol>¶</font>y)]))].<p><A NAME="tth_fIg5.1"></A>           <center><p><tt><br>Picture Omitted<br></tt></center>               <center>      Figure 5.1: Existence requirements</center>              <A NAME="DifEq-f1"></A>              <p><p>        <H2><A NAME="tth_sEc5.2">5.2</A>&nbsp;&nbsp;Euler's Method</H2><p><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>y<sub>0</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(0) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>y<sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x<sub>0</sub>+h) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y<sub>0</sub>+hf(x<sub>0</sub>,y<sub>0</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>y<sub>n</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x<sub>0</sub>+nh) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>y<sub>n-1</sub>+hf(x<sub>n-1</sub>,y<sub>n-1</sub>) </td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Error is given by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>Y(x)-y<sub>h</sub>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>hD(x)+<font face="helvetica"><i>O</i></font>(h<sup>2</sup>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>D<font face=symbol>¢</font>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>g(x)D(x)+</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>Y<font face=symbol>¢</font><font face=symbol>¢</font>(x), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D(x<sub>o</sub>) = 0 </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>g(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center><font face=symbol>¶</font>f(x,z)<hr NOSHADE> <font face=symbol>¶</font>z<Br></td><td align=left class="cl"><font face=symbol>ê<br>ê<br>ê</font></td><td nowrap align=center><font size="-1"></font> <Br><br><font size="-1">z = Y(x)</font>&nbsp;<br></td><td nowrap></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>        <H2><A NAME="tth_sEc5.3">5.3</A>&nbsp;&nbsp;Runge-Kutta</H2><p>While Euler's method is nice and simple, it is far from the best.  Higher order Taylor methods can be derived but these require evaluating multiple derivatives.  Even Richardson's extrapolation has limits on its abilities.<p>Consider the Taylor series of y.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>y(x+h) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x)+hy<font face=symbol>¢</font>(x)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>y<font face=symbol>¢</font><font face=symbol>¢</font>(x)+<font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x)+hf(x,y)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>f<font face=symbol>¢</font>(x,y)+<font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x)+hf(x,y)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>(f<sub>x</sub>(x,y)+f<sub>y</sub>(x,y)f(x,y)) +<font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x)+hf(x,y)+</td><td nowrap align=center>h<sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>(f<sub>x</sub>(x,y)+f<sub>y</sub>(x,y)f(x,y)) +<font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>y(x)+hf(x,y)+ah</td><td align=left class="cl"><font face=symbol>æ<br>ç<br>è</font></td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>f<sub>x</sub>(x,y)+ </td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>f(x,y)f<sub>y</sub>(x,y)</td><td align=left class="cl"><font face=symbol>ö<br>÷<br>ø</font></td><td nowrap align=center>+<font face=symbol>¼</font></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Now we consider the Taylor series in two variables of f(x,y).<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f(x+h,y+k) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><font size="-1"><font face=symbol>¥</font></font> <Br><font face=symbol size="+3">å<br></font><font size="-1">n = 0</font>&nbsp;<br></td><td nowrap></td><td nowrap align=center>1<hr NOSHADE> n!<Br></td><td nowrap align=center></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ë</font></td><td nowrap align=center>h</td><td nowrap align=center><font face=symbol>¶</font><hr NOSHADE> <font face=symbol>¶</font>x<Br></td><td nowrap align=center>+k</td><td nowrap align=center><font face=symbol>¶</font><hr NOSHADE> <font face=symbol>¶</font>y<Br></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>û</font></td><td nowrap align=center><font size="-1">n</font> <Br><br><font size="-1"></font>&nbsp;<br></td><td nowrap>f(x,y) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f(x,y) +</td><td align=left class="cl"><font face=symbol>é<br>ê<br>ë</font></td><td nowrap align=center>h</td><td nowrap align=center><font face=symbol>¶</font><hr NOSHADE> <font face=symbol>¶</font>x<Br></td><td nowrap align=center>+k</td><td nowrap align=center><font face=symbol>¶</font><hr NOSHADE> <font face=symbol>¶</font>y<Br></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>û</font></td><td nowrap align=center>f(x,y) + <font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>f(x,y) +hf<sub>x</sub>(x,y)+kf<sub>y</sub>(x,y) + <font face=symbol>¼</font></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Rearranging we find<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f(x+h,y+k) -f(x,y)  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>hf<sub>x</sub>(x,y)+kf<sub>y</sub>(x,y) + <font face=symbol>¼</font>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We use this in our Taylor series of y.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>y(x+h)  </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x)+hf(x,y)+ah</td><td align=left class="cl"><font face=symbol>æ<br>ç<br>è</font></td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>f<sub>x</sub>(x,y)+</td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>f(x,y)f<sub>y</sub>(x,y)</td><td align=left class="cl"><font face=symbol>ö<br>÷<br>ø</font></td><td nowrap align=center>+<font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x)+hf(x,y)+h</td><td align=left class="cl"><font face=symbol>æ<br>ç<br>è</font></td><td nowrap align=center>af(x+</td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>,y+</td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>f(x,y)) -af(x,y)</td><td align=left class="cl"><font face=symbol>ö<br>÷<br>ø</font></td><td nowrap align=center>+<font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x)+h(1-a)f(x,y)+ahf(x+</td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>,y+</td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>f(x,y)) +<font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y(x)+h(1-a)f(x,y)+ahf(x+b,y+bf(x,y)) +<font face=symbol>¼</font></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b = </td><td nowrap align=center>h<hr NOSHADE> 2a<Br></td><td nowrap align=center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 <font face=symbol>£</font> a  <font face=symbol>£</font> 1</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We have defined this in order to take advantage of the many varieties of second order R-K.  The most common are: Midpoint (a=1), Modified Euler (a=1/2), and Heun's method (a=3/4).<p>You can also do R-K for higher orders.  The most common is fourth order.  The algebra is tedious so I will just present the result.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>y(x+h) = y(x)+</td><td nowrap align=center>1<hr NOSHADE> 6<Br></td><td nowrap align=center>(F<sub>1</sub>+2F<sub>2</sub>+2F<sub>3</sub>+F<sub>4</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>with<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>F<sub>1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>hf(x,y) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>F<sub>2</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>hf(x+</td><td nowrap align=center>h<hr NOSHADE> 2<Br></td><td nowrap align=center>,y+</td><td nowrap align=center>F<sub>1</sub><hr NOSHADE> 2<Br></td><td nowrap align=center>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>F<sub>3</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>hf(x+</td><td nowrap align=center>h<hr NOSHADE> 2<Br></td><td nowrap align=center>,y+</td><td nowrap align=center>F<sub>2</sub><hr NOSHADE> 2<Br></td><td nowrap align=center>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>F<sub>4</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>hf(x+h,y+F<sub>3</sub>)</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p>        <H2><A NAME="tth_sEc5.4">5.4</A>&nbsp;&nbsp;Fehlberg's Method</H2><p>We have seen that the local error (error in one step due mostly to truncation) is one order of magnitude better than the global error, in general.  Often we use Richardson's Error formula to find an estimate of the local error (T<sub>n</sub>) so we can adjust the step size to keep things nice.  For instance Richardson's Error for Euler's method gives us<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>Y(x)-y<sub>h</sub>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>hD(x) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>Y(x)-y<sub>2h</sub>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>2hD(x) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>Y(x)-y<sub>2h</sub>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>2(Y(x)-y<sub>h</sub>(x)) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>Y(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>2y<sub>h</sub>(x)-y<sub>2h</sub>(x) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>Y(x)-y<sub>h</sub>(x) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>(2y<sub>h</sub>(x)-y<sub>2h</sub>(x))-y<sub>h</sub>(x) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>y<sub>h</sub>(x)-y<sub>2h</sub>(x).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This gives us a reasonable extrapolation formula, and estimate of the error.  Another way to estimate the error would be to look at two estimates from different order methods.  For instance you could do a fourth and a fifth order R-K estimate at each step and use the difference to bound the error.  If the error at any step became to large then you would decrease the step size and try again.  This idea is Fehlberg's method, and it is the basis of most modern ode solvers.  This is why Matlab has ode23 and ode45.<p>        <H2><A NAME="tth_sEc5.5">5.5</A>&nbsp;&nbsp;Adams-Bashforth</H2><p>Up till now we have been looking at solving the differential equation directly.  We could however just integrate both sides.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>y<font face=symbol>¢</font></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>f(x,y) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">x<sub>n+1</sub></font> <Br><br><font size="-1">x<sub>n</sub></font>&nbsp;<br></td><td nowrap>y<font face=symbol>¢</font>dx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">x<sub>n+1</sub></font> <Br><br><font size="-1">x<sub>n</sub></font>&nbsp;<br></td><td nowrap>f(x,y)dx </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>y(x<sub>n+1</sub>)-y(x<sub>n</sub>) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">x<sub>n+1</sub></font> <Br><br><font size="-1">x<sub>n</sub></font>&nbsp;<br></td><td nowrap>f(x,y)dx </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left>y(x<sub>n+1</sub>) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>y(x<sub>n</sub>) + </td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">x<sub>n+1</sub></font> <Br><br><font size="-1">x<sub>n</sub></font>&nbsp;<br></td><td nowrap>f(x,y)dx</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>Our task is now reduced to trying to find the remaining integral, which we can use the ideas we had from last chapter.  Adams-Bashforth of order m uses a polynomial approximation to f(x,y) at the points x<sub>n</sub>, x<sub>n-1</sub>, ..., x<sub>n-m+1</sub>.  Consider the second order Adams-Bashforth method.<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>f(x,y(x)) </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>x<sub>n</sub>-x<hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n-1</sub>)+</td><td nowrap align=center>x-x<sub>n-1</sub><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">x<sub>n+1</sub></font> <Br><br><font size="-1">x<sub>n</sub></font>&nbsp;<br></td><td nowrap>f(x,y)dx </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td align=left class="cl"><font face=symbol>ó<br>õ</font></td><td nowrap align=center><font size="-1">x<sub>n+1</sub></font> <Br><br><font size="-1">x<sub>n</sub></font>&nbsp;<br></td><td nowrap></td><td align=left class="cl"><font face=symbol>æ<br>ç<br>è</font></td><td nowrap align=center> </td><td nowrap align=center>x<sub>n</sub>-x<hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n-1</sub>)+</td><td nowrap align=center>x-x<sub>n-1</sub><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td><td align=left class="cl"><font face=symbol>ö<br>÷<br>ø</font></td><td nowrap align=center>dx </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> </td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>x<sub>n</sub>x-</td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>x<sup>2</sup></td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n-1</sub>)+ </td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>1<hr NOSHADE> 2<Br></td><td nowrap align=center>x<sup>2</sup>-x<sub>n-1</sub>x</td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td><td align=left class="cl"><font face=symbol>ê<br>ê<br>ê<br>ê<br>ê<br>ê</font></td><td nowrap align=center><font size="-1">x<sub>n+1</sub></font> <Br><br><br><br><font size="-1">x<sub>n</sub></font>&nbsp;<br></td><td nowrap></td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>x<sub>n</sub>h-</td><td nowrap align=center>x<sub>n+1</sub><sup>2</sup>-x<sub>n</sub><sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center></td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n-1</sub>)+ </td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>x<sub>n+1</sub><sup>2</sup>-x<sub>n</sub><sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>-x<sub>n-1</sub>h</td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>x<sub>n</sub>h-</td><td nowrap align=center>x<sub>n+1</sub><sup>2</sup>-x<sub>n+1</sub>x<sub>n</sub>+x<sub>n+1</sub>x<sub>n</sub>-x<sub>n</sub><sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center></td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n-1</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + </td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>x<sub>n+1</sub><sup>2</sup>-x<sub>n+1</sub>x<sub>n</sub>+x<sub>n+1</sub>x<sub>n</sub>-x<sub>n</sub><sup>2</sup><hr NOSHADE> 2<Br></td><td nowrap align=center>-x<sub>n-1</sub>h</td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center>x<sub>n</sub>h-</td><td nowrap align=center>x<sub>n+1</sub>h+x<sub>n</sub>h<hr NOSHADE> 2<Br></td><td nowrap align=center></td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n-1</sub>)+ </td><td nowrap align=center><tabLe border=0><tr><td nowrap align=center></td><td nowrap align=center>x<sub>n+1</sub>h+x<sub>n</sub>h<hr NOSHADE> 2<Br></td><td nowrap align=center>-x<sub>n-1</sub>h</td></tabLe><hr NOSHADE> h<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>2x<sub>n</sub>-(x<sub>n+1</sub>+x<sub>n</sub>)<hr NOSHADE> 2<Br></td><td nowrap align=center>f(x<sub>n-1</sub>)+ </td><td nowrap align=center>x<sub>n+1</sub>+x<sub>n</sub>-2x<sub>n-1</sub><hr NOSHADE> 2<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>x<sub>n</sub>-x<sub>n+1</sub><hr NOSHADE> 2<Br></td><td nowrap align=center>f(x<sub>n-1</sub>)+ </td><td nowrap align=center>x<sub>n+1</sub>-x<sub>n-1</sub>+x<sub>n</sub>-x<sub>n-1</sub><hr NOSHADE> 2<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left></td><td nowrap align=center>-h<hr NOSHADE> 2<Br></td><td nowrap align=center>f(x<sub>n-1</sub>)+</td><td nowrap align=center>2h+h<hr NOSHADE> 2<Br></td><td nowrap align=center>f(x<sub>n</sub>) </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> <font face=symbol>»</font> </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>h<hr NOSHADE> 2<Br></td><td nowrap align=center>(3f(x<sub>n</sub>)-f(x<sub>n-1</sub>))</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>This is kind of ugly, so it would be nice to have a faster way of handling things, especially as the dimensions increase.  Luckily there is just such a technique.  The method of undetermined coefficients.<p>        <H2><A NAME="tth_sEc5.6">5.6</A>&nbsp;&nbsp;Adams-Moulton</H2><p>        <H2><A NAME="tth_sEc5.7">5.7</A>&nbsp;&nbsp;Stability &amp; Stiff Equations</H2>A good start for looking at stiff equations is to examine the stability of our methods.  Consider Forward Euler for<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>y<font face=symbol>¢</font> = -200y, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y(1) = e<sup>-200</sup>.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The solution can easily be seen to be e<sup>-200x</sup>.  Forward Euler gives us<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>y<sub>i+1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y<sub>i</sub>-200*h*y<sub>i</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>y<sub>i</sub>(1-200*h).</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>We note that this is stable if <font face=symbol>||</font> 1-200*h <font face=symbol>||</font> &lt; 1.  Since h &gt; 0 we must have h &lt; 0.01.  This is a smooth, monotonically decreasing function that is less than 2\time10<sup>-87</sup> and greater than zero.  Despite the smoothness and flatness, we have to take very small steps.  To see this look at Figure&nbsp;<A href="#stabfig">5.2</A>.<p><A NAME="tth_fIg5.2"></A> <p><center><a href="stab.eps">Figure</a></center> <center>      Figure 5.2: Instability in Euler's Method</center><A NAME="stabfig"></A><p><p>Note that Backward Euler does not have the same problem.  It is defined by<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><tabLe border=0><tr><td nowrap Align=left>y<sub>i+1</sub> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left>y<sub>i</sub>-200*h*y<sub>i+1</sub> </td></tabLe></TD></TR><TR><TD NOWRAP align="right" colspan=0><tabLe border=0><tr><td nowrap Align=left> </td></tabLe></td><td nowrap align=left><tabLe border=0><tr><td nowrap Align=left> = </td></tabLe></td><td nowrap align=left><table><TR><TD nowrap align="right" colspan=0>y<sub>i</sub></td><td nowrap align=center>1<hr NOSHADE> 1+200*h<Br></td><td nowrap align=center>,</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>which is stable for all h &gt; 0. Stability is not the same thing as stiffness, but they are related.  Stiffness is due to multiple scales of the terms, for instance e<sup>-x</sup>, e<sup>-200x</sup>.  Consider the following equation<centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0>y<font face=symbol>¢</font><font face=symbol>¢</font>+1001y<font face=symbol>¢</font>+1000y = 0, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y(0) = 1, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y<font face=symbol>¢</font>(0) = -1.</td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr>The solution can easily be seen to be e<sup>-x</sup>, which is nice in any definition.  We solve the equation using a 4th order R-K method.  The results are in Figure&nbsp;<A href="#stifffig">5.3</A>.<p><A NAME="tth_fIg5.3"></A> <p><center><a href="stiff.eps">Figure</a></center> <center>      Figure 5.3: Stiff Equation</center><A NAME="stifffig"></A><p><p>What is going on?  We need to look at the eigenvalues.<p>      <H1><A NAME="tth_chAp6">Chapter 6     </A><br>Modeling and Simulation</H1><A NAME="c-ModSim"></A>Some systems cannot be practically tested.  Consider the spread of a highlyinfectious disease, or the destruction due to a nuclear war.  We can look at smaller examples of these, but the full blown case would be bad to run.  What we would like to do is to take our mathematical knowledge and create a system of equations which will have the same behaviour.  We can then test the real system by seeing how the modeled system behaves.  This action of making a a mathematical model be similar to the real system is simulation (same root as similar).  Often these systems are expressed as either differential or difference equations.  They can thus be solved by our differential equation solvers directly, or transformed (Laplace, Fourier, Z, etc.) so they can be solved by zero-finding.<p>Lets look at how we can set some of these up, and then give some examples.<p>      <H3><A NAME="tth_sEc6.0.1">6.0.1</A>&nbsp;&nbsp;Arms race</H3><centEr><table border=0 align=center><tr><td><Table align=left><tr><td nowrap align=center></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=right><table><TR><TD nowrap align="right" colspan=0></td><td nowrap align=center>.<br><tabLe border=0><tr><td nowrap align=center></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>x<sub>1</sub></td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0> x<sub>2</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>û</font></td><td nowrap align=center></td></tabLe>&nbsp;<br></td><td nowrap align=center> = </td><td align=left class="cl"><font face=symbol>é<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>-m<sub>1</sub> </td></tabLe></td><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>a<sub>1</sub></td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><tabLe border=0><tr><td nowrap Align=center> a<sub>2</sub> </td></tabLe></td><td nowrap align=center><table><TR><TD nowrap align="center" colspan=0>-m<sub>2</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>û</font></td><td nowrap align=center></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>x<sub>1</sub></td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0> x<sub>2</sub></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>û</font></td><td nowrap align=center></td><td align=left class="cl"><font face=symbol>é<br>ê<br>ë</font></td><td nowrap><TablE border=0 align=left><tr><td nowrap align=center><tabLe border=0><tr><td nowrap Align=center>b<sub>1</sub>x<sub>2</sub><sup>2</sup></td></tabLe></TD></TR><TR><TD NOWRAP align="center" colspan=0><table><TR><TD nowrap align="center" colspan=0> b<sub>2</sub>x<sub>1</sub><sup>2</sup></td></tabLe></TD></TR></TablE></td><td nowrap></td><td align=left class="cl"><font face=symbol>ù<br>ú<br>û</font></td><td nowrap align=center></td></tabLe></TD></TR></TablE></td><td nowrap></td></Table></td></table></centEr><p><p><hr><small>File translated from T<sub><font size="-1">E</font></sub>X by <a href="http://hutchinson.belmont.ma.us/tth/">T<sub><font size="-1">T</font></sub>H</a>, version 2.25.<br>On  3 May 2001, 09:51.</small></HTML>