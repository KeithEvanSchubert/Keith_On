Ftrue2 = [ 1  1  1  1  1  1
          1  1  2  2  1  1
          1  2  3  6  2  1
          1  2  5 12  4  1
          1  2  4  9  3  1
          1  1  1  1  1  1]';
Ftrue=matrix(Ftrue2,36,1);

W = [ 1 1 1 1 1 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 0 0  1 1 1 1 1 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  1 1 1 1 1 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 1 1 1 1 1  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 1 1 1 1 1  0 0 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 1 1 1 1 1
      1 0 0 0 0 0  1 0 0 0 0 0  1 0 0 0 0 0  1 0 0 0 0 0  1 0 0 0 0 0  1 0 0 0 0 0
      0 1 0 0 0 0  0 1 0 0 0 0  0 1 0 0 0 0  0 1 0 0 0 0  0 1 0 0 0 0  0 1 0 0 0 0
      0 0 1 0 0 0  0 0 1 0 0 0  0 0 1 0 0 0  0 0 1 0 0 0  0 0 1 0 0 0  0 0 1 0 0 0
      0 0 0 1 0 0  0 0 0 1 0 0  0 0 0 1 0 0  0 0 0 1 0 0  0 0 0 1 0 0  0 0 0 1 0 0
      0 0 0 0 1 0  0 0 0 0 1 0  0 0 0 0 1 0  0 0 0 0 1 0  0 0 0 0 1 0  0 0 0 0 1 0
      0 0 0 0 0 1  0 0 0 0 0 1  0 0 0 0 0 1  0 0 0 0 0 1  0 0 0 0 0 1  0 0 0 0 0 1
      0 0 0 0 0 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 1 0  0 0 0 0 0 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 1 0 0  0 0 0 0 1 0  0 0 0 0 0 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 1 0 0 0  0 0 0 1 0 0  0 0 0 0 1 0  0 0 0 0 0 1  0 0 0 0 0 0  0 0 0 0 0 0
      0 1 0 0 0 0  0 0 1 0 0 0  0 0 0 1 0 0  0 0 0 0 1 0  0 0 0 0 0 1  0 0 0 0 0 0
      1 0 0 0 0 0  0 1 0 0 0 0  0 0 1 0 0 0  0 0 0 1 0 0  0 0 0 0 1 0  0 0 0 0 0 1
      0 0 0 0 0 0  1 0 0 0 0 0  0 1 0 0 0 0  0 0 1 0 0 0  0 0 0 1 0 0  0 0 0 0 1 0
      0 0 0 0 0 0  0 0 0 0 0 0  1 0 0 0 0 0  0 1 0 0 0 0  0 0 1 0 0 0  0 0 0 1 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 0 0 0 0 0  0 1 0 0 0 0  0 0 1 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 0 0 0 0 0  0 1 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 0 0 0 0 0
      1 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 1 0 0 0 0  1 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 1 0 0 0  0 1 0 0 0 0  1 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 1 0 0  0 0 1 0 0 0  0 1 0 0 0 0  1 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 1 0  0 0 0 1 0 0  0 0 1 0 0 0  0 1 0 0 0 0  1 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 0 1  0 0 0 0 1 0  0 0 0 1 0 0  0 0 1 0 0 0  0 1 0 0 0 0  1 0 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 1  0 0 0 0 1 0  0 0 0 1 0 0  0 0 1 0 0 0  0 1 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 1  0 0 0 0 1 0  0 0 0 1 0 0  0 0 1 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 1  0 0 0 0 1 0  0 0 0 1 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 1  0 0 0 0 1 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 1
      0 0 0 1 1 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      1 1 1 0 0 0  0 0 0 1 1 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 0 0  1 1 1 0 0 0  0 0 0 1 1 1  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  1 1 1 0 0 0  0 0 0 1 1 1  0 0 0 0 0 0  0 0 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 1 1 0 0 0  0 0 0 1 1 1  0 0 0 0 0 0
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 1 1 0 0 0  0 0 0 1 1 1
      0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  0 0 0 0 0 0  1 1 1 0 0 0];
Etrue = W*Ftrue;
Emeas = Etrue + 0.*rand(Etrue);
Fest=W\Emeas;
RelErr=norm(Fest-Ftrue)/norm(Ftrue);
Fimg=matrix(Fest,6,6);
Matplot([Fimg,Ftrue2]);

